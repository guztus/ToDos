{"version":3,"sources":["webpack:///./node_modules/@bosket/tools/arrays.js","webpack:///./node_modules/@bosket/tools/trees.js","webpack:///./node_modules/@bosket/tools/mixin.js","webpack:///./node_modules/@bosket/tools/css.js","webpack:///./node_modules/@bosket/tools/objects.js","webpack:///./node_modules/@bosket/core/dragndrop.js","webpack:///./node_modules/@bosket/core/strategies.js","webpack:///./node_modules/@bosket/core/defaults.js","webpack:///./node_modules/@bosket/core/logic.js","webpack:///./node_modules/@bosket/vue/traits/labels.js","webpack:///./node_modules/@bosket/vue/traits/transitions.js","webpack:///./node_modules/@bosket/vue/traits/listener.js","webpack:///./node_modules/@bosket/vue/components/TreeViewNode.js","webpack:///./node_modules/@bosket/vue/components/TreeView.js","webpack:///./node_modules/@bosket/vue/traits/index.js","webpack:///./node_modules/babel-helper-vue-jsx-merge-props/index.js"],"names":["array","self","last","length","arr","otherCondition","filter","elt","indexOf","notIn","is","_ref","_ref$isIn","isIn","undefined","_ref$notIn","reduce","acc","curr","contains","element","allIn","every","_extends","Object","assign","target","i","arguments","source","key","prototype","hasOwnProperty","call","_toConsumableArray","Array","isArray","arr2","from","tree","t","prop","flatten","flattened","fifo","_tree","pop","concat","item","map","filterFun","copy","recurse","list","forEach","filterMap","finalMap","Map","childMap","size","set","perform","cb","path","reverse","p","idx","add","parent","remove","_","check","visit","visitor","_tree2","child","push","unwrapTree","unwrapCheck","Promise","all","children","then","resolve","Symbol","iterator","css","_classes","_key","join","cname","HTMLElement","className","split","c","_slicedToArray","_arr","_n","_d","_e","_s","_i","next","done","value","err","sliceIterator","TypeError","_defineProperty","obj","defineProperty","enumerable","configurable","writable","object","Error","shallowCompare","excludes","equals","fun","fullMap","_fun","_fun2","newProp","newVal","nestPrefix","prefix","transform","startsWith","substring","hoverReferences","itemRef","guardCheck","nodeEvents","event","stopPropagation","this","inputs","get","dragndrop","onDrag","preventDefault","guard","dataTransfer","dropEffect","currentTarget","mixCss","onOver","hasChildren","isAsync","state","unfolded","onEnter","onLeave","onDrop","onCancel","_this","selection","onSelect","ancestors","neighbours","outputs","alreadySelected","newSelection","category","selectionStrategies","single","multiple","modifiers","control","meta","lastSelection","lastIndex","lastPivot","bind","shift","originIndex","slice","endIndex","_newSelection","_ref2","_smaller","_higher","deletions","_ref4","smaller","higher","additions","disabled","apply","_ancestors","_x","_x2","_x3","_x4","toString","clickStrategies","select","model","isSelected","newUnfolded","foldStrategies","_this2","recurseCheck","node","some","maxDepth","isNaN","parseInt","depth","defaults","labels","TreeView","opener","selected","folded","async","loading","nodrop","dragover","search","strategies","click","fold","display","openerOpts","position","draggable","droppable","_createClass","defineProperties","props","descriptor","Constructor","protoProps","staticProps","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_classCallCheck","instance","Core","refresh","_Core","TreeNode","_temp","_len","args","getPrototypeOf","isFolded","strats","searched","strat","isDisabled","disabledFun","isDraggable","isDroppable","ulCss","liCss","_css$classes2","pending","unwrapPromise","asyncFun","res","catch","e","reject","onClick","getDragEvents","condition","result","onDragStart","onDragOver","onDragEnter","onDragLeave","onDragEnd","_key2","callback","_Core2","RootNode","_temp2","_this3","_len2","_key3","onKey","getModifierState","wrapDragNDrop","filterTree","input","trim","withListener","_ref$eventType","eventType","_ref$prop","_ref$mountOn","mountOn","_ref$autoMount","autoMount","_ref$regulate","regulate","Component","name","created","mount","beforeDestroy","unmount","beforeUpdate","$props","data","listening","ticking","methods","subscribe","onEvent","window","requestAnimationFrame","document","addEventListener","removeEventListener","render","h","listener","TreeViewNodeBase","_inputs","_state","$data","s","_unmounted","$forceUpdate","computed","childrenModel","sort","rootDragData","rootData","attrs","toLowerCase","renderSubtree","filteredModel","TreeViewNode","renderOpener","OpenerComponent","on","onOpener","_$props","m","has","rawLiData","liData","unique","transition","_objectWithoutProperties","keys","defaultLabels","TreeViewBase","searchInput","filtered","onSearch","evt","rootNode","computedModel","_props","_outputs","drag","over","enter","leave","drop","cancel","mounted","keyUpListener","keyDownListener","_object$filter","rest","searchBar","type","placeholder","domProps","factories","accu","factory","combine","nestRE","mergeFn","a","b","module","exports","objs","aa","bb","nestedKey","temp","test"],"mappings":"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","file":"7.js","sourcesContent":["\n\nexport var array = function array(self) {\n    return {\n        last: function last() {\n            return self.length > 0 ? self[self.length - 1] : null;\n        },\n        \"in\": function _in(arr, otherCondition) {\n            return self.filter(function (elt) {\n                return arr.indexOf(elt) >= 0 && (!otherCondition || otherCondition(elt));\n            });\n        },\n        notIn: function notIn(arr, otherCondition) {\n            return self.filter(function (elt) {\n                return arr.indexOf(elt) < 0 && (!otherCondition || otherCondition(elt));\n            });\n        },\n        is: function is(_ref, otherCondition) {\n            var _ref$isIn = _ref.isIn,\n                isIn = _ref$isIn === undefined ? [] : _ref$isIn,\n                _ref$notIn = _ref.notIn,\n                notIn = _ref$notIn === undefined ? [] : _ref$notIn;\n            return self.filter(function (elt) {\n                return isIn.reduce(function (acc, curr) {\n                    return curr.indexOf(elt) >= 0 && acc;\n                }, true) && notIn.reduce(function (acc, curr) {\n                    return curr.indexOf(elt) < 0 && acc;\n                }, true) && (!otherCondition || otherCondition(elt));\n            });\n        },\n        contains: function contains(element) {\n            return self.indexOf(element) >= 0;\n        },\n        allIn: function allIn(arr) {\n            return self.every(function (elt) {\n                return arr.indexOf(elt) >= 0;\n            });\n        }\n    };\n};\n//# sourceMappingURL=arrays.js.map","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nimport { array } from \"./arrays\";\n\n// crashes gen-flow-files : type treeMap<T> = Map<T, treeMap<T>>\n\n\nexport var tree = function tree(t, prop) {\n    return {\n        /**\n         * Flattens the tree into a single array.\n         * @return {Array} A flattened array containing all the tree elements\n         */\n        flatten: function flatten() {\n            var flattened = [];\n            var fifo = [t];\n            while (fifo.length > 0) {\n                var _tree = fifo.pop();\n                if (!(_tree instanceof Array)) continue;\n                flattened = [].concat(_toConsumableArray(array(flattened).notIn(_tree)), _toConsumableArray(_tree));\n                fifo = [].concat(_toConsumableArray(fifo), _toConsumableArray(_tree.filter(function (item) {\n                    return item[prop];\n                }).map(function (item) {\n                    return item[prop];\n                })));\n            }\n\n            return flattened;\n        },\n        /**\n         * Filters the tree.\n         * @param  {Function} filterFun Filtering function\n         * @return {Tree}               Clone of the original tree without the filtered elements\n         */\n        filter: function filter(filterFun) {\n            var copy = t.filter(filterFun);\n            var recurse = function recurse(list) {\n                list.forEach(function (item) {\n                    if (item[prop] && item[prop] instanceof Array) {\n                        item[prop] = item[prop].filter(filterFun);\n                        recurse(item[prop]);\n                    }\n                });\n            };\n            recurse(copy);\n            return copy;\n        },\n        /**\n         * Filters the tree and returns a Map representing the filtered tree.\n         * @param  {Function} filterFun Filtering function\n         * @return {Map}                A Map representation of the filtered tree\n         */\n        filterMap: function filterMap(filterFun) {\n            var finalMap = new Map();\n\n            var recurse = function recurse(list, map) {\n                list.forEach(function (item) {\n                    if (item[prop] && item[prop] instanceof Array) {\n                        var childMap = new Map();\n                        recurse(item[prop], childMap);\n                        if (childMap.size > 0) {\n                            map.set(item, childMap);\n                        } else if (filterFun(item)) {\n                            map.set(item, new Map());\n                        }\n                    } else if (filterFun(item)) {\n                        map.set(item, null);\n                    }\n                });\n            };\n            recurse(t, finalMap);\n            return finalMap;\n        },\n        /**\n         * Perform an action on a tree element, then update its ancestors references.\n         * @param  {T}          elt           Element on which to perform the action (or matching function)\n         * @param  {Function}   cb            An action callback\n         * @param  {Array}      [path=null]   Ancestors path\n         * @return {Tree}                     An updated tree clone\n         */\n        perform: function perform(elt, cb) {\n            var path = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n            if (!path) path = tree(t, prop).path(elt);\n            if (path instanceof Array) {\n                path.reverse().forEach(function (p, idx) {\n                    if (idx === 0) cb(p);else p[prop] = [].concat(_toConsumableArray(p[prop]));\n                });\n                return [].concat(_toConsumableArray(t));\n            } else {\n                return t;\n            }\n        },\n        /**\n         * Adds an element and update its ancestors references.\n         * @param {T}       parent        Where to add\n         * @param {T}       elt           What to add (or matching function)\n         * @param {Array}   [path=null]   Ancestors path\n         * @return {Tree}                 An updated tree clone\n         */\n        add: function add(parent, elt) {\n            var path = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n            return tree(t, prop).perform(parent, function (p) {\n                return p[prop] = [].concat(_toConsumableArray(p[prop]), [elt]);\n            }, path);\n        },\n        /**\n         * Removes an element and update its ancestors references.\n         * @param  {T}      parent      Where to remove\n         * @param  {T}      elt         What to remove (or matching function)\n         * @param  {Array}  [path=null] Ancestors path\n         * @return {Tree}               An updated tree clone\n         */\n        remove: function remove(parent, elt) {\n            var path = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n            return tree(t, prop).perform(parent, function (p) {\n                p[prop] = p[prop].filter(function (_) {\n                    if (typeof elt === \"function\") return !elt(_);\n                    return _ !== elt;\n                });\n            }, path);\n        },\n        /**\n         * Retrieves all ancestors of an element (or returns false).\n         * @param  {T}      elt Element to search for (or matching function)\n         * @return {Array}      Ancestors path\n         */\n        path: function path(elt) {\n            var recurse = function recurse(item) {\n                if (item === elt || typeof elt === \"function\" && elt(item)) return [item];\n                if (!item[prop]) return false;\n                for (var i = 0; i < item[prop].length; i++) {\n                    var check = recurse(item[prop][i]);\n                    if (check) return [item].concat(_toConsumableArray(check));\n                }\n                return false;\n            };\n            for (var i = 0; i < t.length; i++) {\n                var check = recurse(t[i]);\n                if (check) return check;\n            }\n            return false;\n        },\n        /**\n         * Visits each node of the tree and performs an action.\n         * @param  {Function} visitor Action to perform.\n         */\n        visit: function visit(visitor) {\n            var fifo = [t];\n            while (fifo.length > 0) {\n                var _tree2 = fifo.pop();\n                visitor(_tree2);\n                _tree2.forEach(function (child) {\n                    return child[prop] && child[prop] instanceof Array ? fifo.push(child[prop]) : null;\n                });\n            }\n        },\n        /**\n         * Resolves asynchronous nodes of the tree (Promises).\n         * @param {Function} unwrapCheck Allows to skip Promises you don't want to unwrap\n         * @return {Promise}\n        */\n        unwrapTree: function unwrapTree() {\n            var unwrapCheck = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function (_) {\n                return true;\n            };\n            return Promise.all(t.map(function (item) {\n                if (!item.children || !unwrapCheck(item)) return Promise.resolve(item);\n                return (typeof item.children === \"function\" ? item.children().then(function (children) {\n                    return tree(children, prop).unwrapTree(unwrapCheck);\n                }) : tree(item.children, prop).unwrapTree(unwrapCheck)).then(function (children) {\n                    return _extends({}, item, {\n                        children: children\n                    });\n                });\n            }));\n        }\n    };\n};\n//# sourceMappingURL=trees.js.map","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nexport var deepMix = function deepMix(one, two) {\n    var mergeArrays = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n    if (!one || !two || (typeof one === \"undefined\" ? \"undefined\" : _typeof(one)) !== \"object\" || (typeof two === \"undefined\" ? \"undefined\" : _typeof(two)) !== \"object\") return one;\n\n    var clone = _extends({}, one, two);\n    for (var prop in two) {\n        if (two.hasOwnProperty(prop)) {\n            if (two[prop] instanceof Array && one[prop] instanceof Array) {\n                clone[prop] = mergeArrays ? [].concat(_toConsumableArray(one[prop]), _toConsumableArray(two[prop])) : two[prop];\n            } else if (_typeof(two[prop]) === \"object\" && _typeof(one[prop]) === \"object\") {\n                clone[prop] = deepMix(one[prop], two[prop], mergeArrays);\n            }\n        }\n    }\n\n    return clone;\n};\n//# sourceMappingURL=mixin.js.map","var css = {\n    classes: function classes(_classes) {\n        var css = [];\n        for (var _key in _classes) {\n            if (_classes[_key]) {\n                css.push(_key);\n            }\n        }\n        return css.join(\" \");\n    },\n    addClass: function addClass(elt, cname) {\n        if (elt instanceof HTMLElement) elt.className = elt.className.split(\" \").filter(function (c) {\n            return c !== cname;\n        }).join(\" \") + \" \" + cname;\n    },\n    removeClass: function removeClass(elt, cname) {\n        if (elt instanceof HTMLElement) elt.className = elt.className.split(\" \").filter(function (c) {\n            return c !== cname;\n        }).join(\" \");\n    },\n    hasClass: function hasClass(elt, cname) {\n        return elt instanceof HTMLElement ? elt.className.indexOf(cname) >= 0 : false;\n    }\n};\nexport { css };\n//# sourceMappingURL=css.js.map","var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nexport var object = function object(self) {\n    if (!self || !(self instanceof Object)) {\n        throw new Error(\"Bad object format\");\n    }\n\n    return {\n        shallowCompare: function shallowCompare(obj, excludes) {\n            var equals = true;\n            for (var key in self) {\n                if (self.hasOwnProperty(key)) {\n                    if (!(excludes && excludes.indexOf(key) >= 0) && obj[key] !== self[key]) {\n                        equals = false;\n                        return;\n                    }\n                }\n            }\n            return equals;\n        },\n        filter: function filter(fun) {\n            var copy = {};\n            for (var prop in self) {\n                if (self.hasOwnProperty(prop) && fun(self[prop])) copy[prop] = self[prop];\n            }\n            return copy;\n        },\n        map: function map(fun) {\n            var copy = {};\n            for (var prop in self) {\n                if (self.hasOwnProperty(prop)) copy[prop] = fun(self[prop]);\n            }\n            return copy;\n        },\n        fullMap: function fullMap(fun) {\n            var copy = {};\n            for (var prop in self) {\n                if (self.hasOwnProperty(prop)) {\n                    var _fun = fun(prop, self[prop]),\n                        _fun2 = _slicedToArray(_fun, 2),\n                        newProp = _fun2[0],\n                        newVal = _fun2[1];\n\n                    copy[newProp] = newVal;\n                }\n            }\n            return copy;\n        },\n        nestPrefix: function nestPrefix(prefix) {\n            var transform = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (_) {\n                return _;\n            };\n\n            var copy = _defineProperty({}, prefix, {});\n            for (var prop in self) {\n                if (self.hasOwnProperty(prop) && prop.startsWith(prefix)) {\n                    copy[prefix][transform(prop.substring(prefix.length))] = self[prop];\n                } else {\n                    copy[prop] = self[prop];\n                }\n            }\n            return copy;\n        }\n    };\n};\n//# sourceMappingURL=objects.js.map","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nimport { css, array, tree } from \"@bosket/tools\";\n\n// Drag and drop presets //\n\nexport var dragndrop = {\n    // Moves the selection //\n    selection: function selection(model, cb) {\n        return {\n            draggable: true,\n            droppable: true,\n            drag: function drag(item, event, inputs) {\n                event.dataTransfer && event.dataTransfer.setData(\"application/json\", JSON.stringify(inputs.selection));\n            },\n            guard: function guard(target, event, inputs) {\n                // Other data types\n                if (event && event.dataTransfer && event.dataTransfer.types.indexOf(\"application/json\") < 0) return false;\n                // Prevent drop on self\n                var selfDrop = function selfDrop() {\n                    return target && array(inputs.selection).contains(target);\n                };\n                // Prevent drop on child\n                var childDrop = function childDrop() {\n                    return inputs.ancestors && inputs.ancestors.reduce(function (prev, curr) {\n                        return prev || array(inputs.selection).contains(curr);\n                    }, false);\n                };\n\n                return selfDrop() || childDrop();\n            },\n            drop: function drop(target, event, inputs) {\n                var updatedModel = tree(model(), inputs.category).filter(function (e) {\n                    return inputs.selection.indexOf(e) < 0;\n                });\n                var adjustedTarget = target ? target[inputs.category] && target[inputs.category] instanceof Array ? target : array(inputs.ancestors).last() : null;\n                if (adjustedTarget) adjustedTarget[inputs.category] = [].concat(_toConsumableArray(adjustedTarget[inputs.category]), _toConsumableArray(inputs.selection));else updatedModel = [].concat(_toConsumableArray(updatedModel), _toConsumableArray(inputs.selection));\n                cb(updatedModel);\n            }\n        };\n    },\n    // Plucks an item on drag\n    pluck: function pluck(model, cb) {\n        return {\n            draggable: true,\n            backup: [],\n            drag: function drag(item, event, inputs) {\n                bak = JSON.stringify(model());\n                event.dataTransfer && event.dataTransfer.setData(\"application/json\", JSON.stringify(item));\n                setTimeout(function () {\n                    return cb(tree(model(), inputs.category).filter(function (e) {\n                        return e !== item;\n                    }));\n                }, 20);\n            },\n            cancel: function cancel() {\n                cb(JSON.parse(bak));\n            }\n        };\n    },\n    // Pastes item(s) on drop\n    paste: function paste(model, cb) {\n        return {\n            droppable: true,\n            drop: function drop(target, event, inputs) {\n                if (event.dataTransfer && event.dataTransfer.types.indexOf(\"application/json\") > -1) {\n                    var data = JSON.parse(event.dataTransfer.getData(\"application/json\"));\n                    var updatedModel = [].concat(_toConsumableArray(model()));\n                    var adjustedTarget = target ? target[inputs.category] && target[inputs.category] instanceof Array ? target : array(inputs.ancestors).last() : null;\n                    if (adjustedTarget) adjustedTarget[inputs.category] = [].concat(_toConsumableArray(adjustedTarget[inputs.category]), [data]);else updatedModel = [].concat(_toConsumableArray(updatedModel), [data]);\n                    cb(updatedModel);\n                }\n            }\n        };\n    }\n};\nvar bak = \"[]\";\n\n// Utils\n\nexport var utils = {\n    // Returns a list of local files/folders dropped\n    filesystem: function filesystem(event) {\n        var items = event.dataTransfer ? event.dataTransfer.items : null;\n        if (items && items.length > 0 && items[0].kind === \"file\") {\n            var files = [];\n            for (var i = 0; i < items.length; i++) {\n                /* eslint-disable */\n                var item = items[i].webkitGetAsEntry() || items[i].getAsFile();\n                /* eslint-enable */\n                if (item) {\n                    files.push(item);\n                }\n            }\n            return files;\n        }\n        return null;\n    }\n\n    // Internal use //\n\n};var hoverReferences = {\n    itemRef: undefined,\n    guardCheck: false\n};\nexport var nodeEvents = {\n    onDragStart: function onDragStart(item) {\n        return function (event) {\n            event.stopPropagation();\n            this.inputs.get().dragndrop.onDrag(item, event, this.inputs.get());\n        };\n    },\n    onDragOver: function onDragOver(item) {\n        return function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            var guardCheck = hoverReferences.itemRef === item ? hoverReferences.guardCheck : this.inputs.get().dragndrop.guard && this.inputs.get().dragndrop.guard(item, event, this.inputs.get());\n\n            if (guardCheck) {\n                if (event.dataTransfer) event.dataTransfer.dropEffect = \"none\";\n                css.addClass(event.currentTarget, this.mixCss(\"nodrop\"));\n            } else {\n                if (event.dataTransfer) event.dataTransfer.dropEffect = \"copy\";\n                css.addClass(event.currentTarget, this.mixCss(\"dragover\"));\n            }\n\n            hoverReferences.itemRef = item;\n            hoverReferences.guardCheck = guardCheck;\n\n            this.inputs.get().dragndrop.onOver(item, event, this.inputs.get());\n        };\n    },\n    onDragEnter: function onDragEnter(item) {\n        return function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n            // If dragging over an opener\n            if (item && (this.hasChildren(item) || this.isAsync(item)) && css.hasClass(event.target, this.mixCss(\"opener\"))) {\n                var newVal = this.state.get().unfolded.filter(function (i) {\n                    return i !== item;\n                });\n                newVal.push(item);\n                this.state.set({ unfolded: newVal });\n            }\n\n            this.inputs.get().dragndrop.onEnter(item, event, this.inputs.get());\n        };\n    },\n    onDragLeave: function onDragLeave(item) {\n        return function (event) {\n            event.stopPropagation();\n            css.removeClass(event.currentTarget, this.mixCss(\"dragover\"));\n            css.removeClass(event.currentTarget, this.mixCss(\"nodrop\"));\n\n            this.inputs.get().dragndrop.onLeave(item, event, this.inputs.get());\n        };\n    },\n    onDrop: function onDrop(item) {\n        return function (event) {\n            event.stopPropagation();\n            css.removeClass(event.currentTarget, this.mixCss(\"dragover\"));\n            css.removeClass(event.currentTarget, this.mixCss(\"nodrop\"));\n            if (!this.inputs.get().dragndrop.guard || !this.inputs.get().dragndrop.guard(item, event, this.inputs.get())) {\n                this.inputs.get().dragndrop.onDrop(item, event, this.inputs.get());\n            }\n        };\n    },\n    onDragEnd: function onDragEnd(item) {\n        return function (event) {\n            event.stopPropagation();\n            if (event.dataTransfer && event.dataTransfer.dropEffect === \"none\") this.inputs.get().dragndrop.onCancel(item, event, this.inputs.get());\n        };\n    }\n};\n\nexport var wrapEvents = function wrapEvents() {\n    var _this = this;\n\n    return _extends({}, this.inputs.get().dragndrop, {\n        onDrag: function onDrag(target, event, inputs) {\n            if (!array(_this.inputs.get().selection).contains(target)) {\n                _this.onSelect(target, inputs.ancestors, inputs.neighbours);\n            }\n\n            _this.outputs.onDrag && _this.outputs.onDrag(target, event, inputs);\n        },\n        onOver: function onOver(target, event, inputs) {\n            _this.outputs.onOver && _this.outputs.onOver(target, event, inputs);\n        },\n        onEnter: function onEnter(target, event, inputs) {\n            _this.outputs.onEnter && _this.outputs.onEnter(target, event, inputs);\n        },\n        onLeave: function onLeave(target, event, inputs) {\n            _this.outputs.onLeave && _this.outputs.onLeave(target, event, inputs);\n        },\n        onDrop: function onDrop(target, event, inputs) {\n            event.preventDefault();\n            _this.outputs.onDrop && _this.outputs.onDrop(target, event, inputs);\n        },\n        onCancel: function onCancel(target, event, inputs) {\n            event.preventDefault();\n            if (event.dataTransfer && event.dataTransfer.dropEffect === \"none\") _this.outputs.onCancel && _this.outputs.onCancel(target, event, inputs);\n        }\n    });\n};\n//# sourceMappingURL=dragndrop.js.map","var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nimport { array, tree } from \"@bosket/tools\";\n\nvar singleSelect = function singleSelect(item, selection, neighbours, ancestors) {\n    return array(selection).contains(item) ? [] : [item];\n};\nvar multiSelect = function multiSelect(item, selection, neighbours, ancestors) {\n    var alreadySelected = false;\n    var newSelection = selection.filter(function (i) {\n        // Mark if the item was already selected\n        if (!alreadySelected) alreadySelected = i === item;\n        // Deselect all ancestors\n        return i !== item && ancestors.indexOf(i) < 0;\n    });\n    // Categories : deselect all children\n    if (!alreadySelected && item[this.inputs.get().category] && item[this.inputs.get().category] instanceof Array) {\n        tree(item[this.inputs.get().category], this.inputs.get().category).visit(function (children) {\n            newSelection = array(newSelection).notIn(children);\n        });\n    }\n    if (!alreadySelected) newSelection.push(item);\n    return newSelection;\n};\n\n// Selection strategies are triggered when the selection is updated.\nexport var selectionStrategies = {\n    // The single strategy allows only one selected item at the same time (usually the last item clicked).\n    single: singleSelect,\n    // The multiple strategy allows any number of selected items and will add the last item clicked to the selection list.\n    multiple: multiSelect,\n    /*\n    The modifiers strategy is the way most file explorers behave.\n    Without keyboard modifiers, only one selected item is allowed.\n    While pressing the shift key, all items between the two last selected siblings are added to the selection array.\n    While pressing the ctrl (or cmd for mac users) key, the item is added to the selection list.\n     */\n    modifiers: function modifiers(item, selection, neighbours, ancestors) {\n        var _this = this;\n\n        if (this.modifiers.control || this.modifiers.meta) {\n            this.lastSelection = item;\n            delete this.lastIndex;\n            delete this.lastPivot;\n            return multiSelect.bind(this)(item, selection, neighbours, ancestors);\n        } else if (this.modifiers.shift) {\n            if (!this.lastSelection) return selection;\n\n            var originIndex = neighbours.indexOf(this.lastSelection);\n            if (originIndex < 0) return selection;\n\n            var newSelection = selection.slice();\n            var endIndex = neighbours.indexOf(item);\n\n            if (originIndex >= 0) {\n                var _newSelection;\n\n                if (this.lastPivot) {\n                    var lastIndex = neighbours.indexOf(this.lastPivot);\n\n                    var _ref = originIndex > lastIndex ? [lastIndex, originIndex] : [originIndex, lastIndex],\n                        _ref2 = _slicedToArray(_ref, 2),\n                        _smaller = _ref2[0],\n                        _higher = _ref2[1];\n\n                    var deletions = neighbours.slice(_smaller, _higher + 1);\n                    newSelection = array(newSelection).notIn(deletions);\n                }\n                this.lastPivot = item;\n\n                var _ref3 = originIndex > endIndex ? [endIndex, originIndex] : [originIndex, endIndex],\n                    _ref4 = _slicedToArray(_ref3, 2),\n                    smaller = _ref4[0],\n                    higher = _ref4[1];\n\n                var additions = !this.inputs.get().disabled ? neighbours.slice(smaller, higher + 1) : neighbours.slice(smaller, higher + 1).filter(function (i) {\n                    return !_this.inputs.get().disabled(i);\n                });\n                newSelection = array(newSelection).notIn(additions);\n                (_newSelection = newSelection).push.apply(_newSelection, _toConsumableArray(additions));\n            }\n\n            return newSelection;\n        } else {\n            this.lastSelection = item;\n            delete this.lastIndex;\n            delete this.lastPivot;\n            return singleSelect.bind(this)(item, selection.length > 1 ? [] : selection, neighbours, ancestors);\n        }\n    },\n    // Selects an item and its ancestors.\n    ancestors: function (_ancestors) {\n        function ancestors(_x, _x2, _x3, _x4) {\n            return _ancestors.apply(this, arguments);\n        }\n\n        ancestors.toString = function () {\n            return _ancestors.toString();\n        };\n\n        return ancestors;\n    }(function (item, selection, neighbours, ancestors) {\n        return selection.length === 0 ? [item] : array(selection).contains(item) ? [].concat(_toConsumableArray(ancestors)) : [].concat(_toConsumableArray(ancestors), [item]);\n    })\n\n    // Click strategies are triggered on item click\n};export var clickStrategies = {\n    // Selects on click\n    select: function select(item) {\n        this.inputs.get().onSelect(item, this.inputs.get().ancestors, this.inputs.get().model);\n    },\n    // Unfold an item when selecting it. Pair it with the \"opener-control\" fold strategy.\n    \"unfold-on-selection\": function unfoldOnSelection(item) {\n        if (!this.isSelected(item)) {\n            var newUnfolded = this.state.get().unfolded.filter(function (i) {\n                return i !== item;\n            });\n            newUnfolded.push(item);\n            this.state.set({ unfolded: newUnfolded });\n        }\n    },\n    // Toggle fold/unfold. Pair it with the \"opener-control\" fold strategy.\n    \"toggle-fold\": function toggleFold(item) {\n        var newUnfolded = this.state.get().unfolded.filter(function (i) {\n            return i !== item;\n        });\n        if (newUnfolded.length === this.state.get().unfolded.length) {\n            newUnfolded.push(item);\n        }\n        this.state.set({ unfolded: newUnfolded });\n    }\n\n    // Fold strategies determine if an item will be folded or not, meaning if its children are hidden.\n};export var foldStrategies = {\n    // Allow the opener (usually an arrow-like element) to control the fold state.\n    \"opener-control\": function openerControl(item) {\n        return !array(this.state.get().unfolded).contains(item);\n    },\n    // Fold when not selected.\n    \"not-selected\": function notSelected(item) {\n        return !this.isSelected(item);\n    },\n    // Unfold as long as there is at least one child selected.\n    \"no-child-selection\": function noChildSelection(item) {\n        var _this2 = this;\n\n        // naive algorithm ...\n        var recurseCheck = function recurseCheck(node) {\n            return _this2.isSelected(node) || node[_this2.inputs.get().category] && node[_this2.inputs.get().category] instanceof Array && node[_this2.inputs.get().category].some(recurseCheck);\n        };\n        return !recurseCheck(item);\n    },\n    // Fold every item deeper than then \"max-depth\" component property.\n    \"max-depth\": function maxDepth() {\n        return this.inputs.get().maxDepth && !isNaN(parseInt(this.inputs.get().maxDepth, 10)) ? this.inputs.get().depth >= parseInt(this.inputs.get().maxDepth, 10) : false;\n    }\n};\n//# sourceMappingURL=strategies.js.map","export var defaults = {\n    labels: {\n        \"search.placeholder\": \"Search ...\"\n    },\n    css: {\n        TreeView: \"TreeView\",\n        opener: \"opener\",\n        depth: \"depth\",\n        selected: \"selected\",\n        category: \"category\",\n        folded: \"folded\",\n        disabled: \"disabled\",\n        async: \"async\",\n        loading: \"loading\",\n        nodrop: \"nodrop\",\n        dragover: \"dragover\",\n        search: \"search\",\n        item: \"item\"\n    },\n    strategies: {\n        selection: [\"single\"],\n        click: [\"select\"],\n        fold: [\"not-selected\", \"no-child-selection\"]\n    },\n    display: function display(_) {\n        return _.toString();\n    },\n    async: function async(_) {\n        return _();\n    },\n    openerOpts: { position: \"right\" },\n    dragndrop: {\n        draggable: false,\n        droppable: false\n    }\n};\n//# sourceMappingURL=defaults.js.map","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport { css, array, tree } from \"@bosket/tools\";\nimport { wrapEvents, nodeEvents } from \"./dragndrop\";\nimport { selectionStrategies, foldStrategies, clickStrategies } from \"./strategies\";\nimport { defaults } from \"./defaults\";\n\n// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //\n//  Boilerplate  for framework class adapters\n\nvar Core = function Core(inputs, outputs, state, refresh) {\n    _classCallCheck(this, Core);\n\n    this.inputs = inputs;\n    this.outputs = outputs;\n    this.state = state;\n    this.refresh = refresh;\n};\n\n// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //\n// Tree node\n\nexport var TreeNode = function (_Core) {\n    _inherits(TreeNode, _Core);\n\n    function TreeNode() {\n        var _ref;\n\n        var _temp, _this, _ret;\n\n        _classCallCheck(this, TreeNode);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = TreeNode.__proto__ || Object.getPrototypeOf(TreeNode)).call.apply(_ref, [this].concat(args))), _this), _this.isSelected = function (item) {\n            return array(_this.inputs.get().selection).contains(item);\n        }, _this.isFolded = function (item) {\n            var strats = _this.inputs.get().strategies;\n            return (!_this.inputs.get().searched || _this.isAsync(item)) && (strats && strats.fold || []).map(function (strat) {\n                return (foldStrategies[strat] || strat).bind(_this);\n            }).reduce(function (last, curr) {\n                return last && curr(item, last);\n            }, true);\n        }, _this.hasChildren = function (item) {\n            return item[_this.inputs.get().category] && item[_this.inputs.get().category] instanceof Array;\n        }, _this.isAsync = function (item) {\n            return !!item && [_this.inputs.get().category] && typeof item[_this.inputs.get().category] === \"function\";\n        }, _this.isDisabled = function (item) {\n            var disabledFun = _this.inputs.get().disabled;\n            return disabledFun ? disabledFun(item) : false;\n        }, _this.isDraggable = function (item) {\n            return item && _this.inputs.get().dragndrop.draggable && (typeof _this.inputs.get().dragndrop.draggable === \"function\" ? _this.inputs.get().dragndrop.draggable(item) : true);\n        }, _this.isDroppable = function (item) {\n            return _this.inputs.get().dragndrop.droppable && (typeof _this.inputs.get().dragndrop.droppable === \"function\" ? _this.inputs.get().dragndrop.droppable(item) : true);\n        }, _this.mixCss = function (prop) {\n            return _this.inputs.get().css[prop] || defaults.css[prop];\n        }, _this.ulCss = function () {\n            return css.classes(_defineProperty({}, _this.mixCss(\"depth\") + \"-\" + (_this.inputs.get().depth || 0), true));\n        }, _this.liCss = function (item) {\n            var _css$classes2;\n\n            return css.classes((_css$classes2 = {}, _defineProperty(_css$classes2, _this.mixCss(\"selected\"), _this.isSelected(item)), _defineProperty(_css$classes2, _this.mixCss(\"category\"), _this.hasChildren(item) || _this.isAsync(item)), _defineProperty(_css$classes2, _this.mixCss(\"folded\"), _this.hasChildren(item) || _this.isAsync(item) ? _this.isFolded(item) : null), _defineProperty(_css$classes2, _this.mixCss(\"disabled\"), _this.isDisabled(item)), _defineProperty(_css$classes2, _this.mixCss(\"async\"), _this.isAsync(item) && _this.isFolded(item)), _defineProperty(_css$classes2, _this.mixCss(\"loading\"), _this.isAsync(item) && !_this.isFolded(item)), _css$classes2));\n        }, _this.pending = [], _this.unwrapPromise = function (item) {\n            _this.pending.push(item);\n            var asyncFun = _this.inputs.get().async;\n            if (!asyncFun) return Promise.reject(new Error(\"Missing async function.\"));else return asyncFun(item[_this.inputs.get().category]).then(function (res) {\n                item[_this.inputs.get().category] = res;\n                _this.refresh();\n            }).catch(function (err) {\n                /* eslint-disable */\n                throw err;\n                /* eslint-enable */\n            }).then(function () {\n                return _this.pending = _this.pending.filter(function (e) {\n                    return e !== item;\n                });\n            });\n        }, _this.onClick = function (item) {\n            return function (event) {\n                if (_this.isDisabled(item)) return;\n                var strats = _this.inputs.get().strategies;\n                (strats && strats.click || []).map(function (strat) {\n                    return (clickStrategies[strat] || strat).bind(_this);\n                }).forEach(function (strat) {\n                    return strat(item, event, _this.inputs.get().ancestors, _this.inputs.get().model);\n                });\n                // this.inputs.get().onSelect(item, this.inputs.get().ancestors, this.inputs.get().model)\n                event.stopPropagation();\n            };\n        }, _this.getDragEvents = function (item) {\n            var condition = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n            if (!condition) return {};\n            var result = {\n                draggable: _this.isDraggable(item),\n                onDragStart: _this.isDraggable(item) && nodeEvents.onDragStart(item).bind(_this),\n                onDragOver: _this.isDroppable(item) && nodeEvents.onDragOver(item).bind(_this),\n                onDragEnter: _this.isDroppable(item) && nodeEvents.onDragEnter(item).bind(_this),\n                onDragLeave: _this.isDroppable(item) && nodeEvents.onDragLeave(item).bind(_this),\n                onDrop: _this.isDroppable(item) && nodeEvents.onDrop(item).bind(_this),\n                onDragEnd: _this.isDraggable(item) && nodeEvents.onDragEnd(item).bind(_this)\n            };\n            for (var _key2 in result) {\n                if (!result[_key2]) delete result[_key2];\n            }return result;\n        }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    /* Various checks */\n\n    /* Styles calculation */\n\n    // Css mixin helper\n\n\n    /* Promises */\n\n    // Pending promises\n\n\n    // Unwrap a promise and mutate the model to add the results\n\n\n    /* Events */\n\n    // On item click\n\n\n    _createClass(TreeNode, [{\n        key: \"onOpener\",\n\n\n        // On opener click\n        value: function onOpener(item, callback) {\n            var _this2 = this;\n\n            return function (event) {\n                var newVal = _this2.state.get().unfolded.filter(function (i) {\n                    return i !== item;\n                });\n                var folded = true;\n                if (newVal.length === _this2.state.get().unfolded.length) {\n                    newVal.push(item);\n                    folded = false;\n                }\n                _this2.state.set({ unfolded: newVal });\n                if (callback) {\n                    callback(item, folded);\n                }\n                event.stopPropagation();\n            };\n        }\n\n        // Drag'n'drop //\n\n    }]);\n\n    return TreeNode;\n}(Core);\n\n// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //\n// Root node of the tree\n\nexport var RootNode = function (_Core2) {\n    _inherits(RootNode, _Core2);\n\n    function RootNode() {\n        var _ref2;\n\n        var _temp2, _this3, _ret2;\n\n        _classCallCheck(this, RootNode);\n\n        for (var _len2 = arguments.length, args = Array(_len2), _key3 = 0; _key3 < _len2; _key3++) {\n            args[_key3] = arguments[_key3];\n        }\n\n        return _ret2 = (_temp2 = (_this3 = _possibleConstructorReturn(this, (_ref2 = RootNode.__proto__ || Object.getPrototypeOf(RootNode)).call.apply(_ref2, [this].concat(args))), _this3), _this3.modifiers = {}, _this3.onKey = function (event) {\n            _this3.modifiers = {\n                control: event.getModifierState(\"Control\"),\n                meta: event.getModifierState(\"Meta\"),\n                shift: event.getModifierState(\"Shift\")\n            };\n        }, _this3.onSelect = function (item, ancestors, neighbours) {\n            var selectionStrategy = _this3.inputs.get().strategies.selection || [];\n            var newSelection = selectionStrategy.map(function (strat) {\n                return (selectionStrategies[strat] || strat).bind(_this3);\n            }).reduce(function (last, curr) {\n                return curr(item, last, neighbours, ancestors);\n            }, _this3.inputs.get().selection);\n            _this3.outputs.onSelect(newSelection, item, ancestors, neighbours);\n            return newSelection;\n        }, _this3.wrapDragNDrop = wrapEvents.bind(_this3), _this3.mixCss = function (prop) {\n            return _this3.inputs.get().css[prop] || defaults.css[prop];\n        }, _this3.filterTree = function (input) {\n            var search = _this3.inputs.get().search;\n            return !search ? null : !input.trim() ? null : tree(_this3.inputs.get().model, _this3.inputs.get().category).filterMap(search(input.trim()));\n        }, _temp2), _possibleConstructorReturn(_this3, _ret2);\n    }\n\n    /* Events */\n\n    // Keyboard modifiers list\n\n\n    // When new element(s) are selected\n\n\n    // Framework input wrapper\n\n\n    // Css mixin helper\n\n\n    // Used to filter the tree when performing a search\n\n\n    return RootNode;\n}(Core);\n//# sourceMappingURL=logic.js.map","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n/* Adds i18n support through customisable labels. */\n\nexport var withLabels = function withLabels(defaultLabels) {\n    return function (Component) {\n        return {\n            name: \"withLabels-\" + Component.name,\n            props: Component.props ? [].concat(_toConsumableArray(Component.props)) : [],\n            render: function render() {\n                var h = arguments[0];\n\n                var props = {\n                    props: _extends({}, this.$props, {\n                        labels: _extends({}, defaultLabels, this.$props.labels)\n                    })\n                };\n                return h(Component, props);\n            }\n        };\n    };\n};\n//# sourceMappingURL=labels.js.map","import _mergeJSXProps from \"babel-helper-vue-jsx-merge-props\";\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n/* Adds transitions on component mount / unmount. */\n\nexport var withTransition = function withTransition(_ref) {\n    var key = _ref.key;\n    return function (Component) {\n        return {\n            name: \"withTransition-\" + Component.name,\n            props: Component.props ? [].concat(_toConsumableArray(Component.props)) : [],\n            render: function render() {\n                var h = arguments[0];\n\n                var props = {\n                    props: _extends({}, this.$props)\n                };\n                var transition = _extends({}, this.transition);\n\n                if (!this.transition) return h(Component, props);\n                return h(\n                    \"transition\",\n                    transition,\n                    [h(Component, _mergeJSXProps([props, { key: key(this.$props) }]))]\n                );\n            }\n        };\n    };\n};\n//# sourceMappingURL=transitions.js.map","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n/* Adds a configurable global listener. */\n\nexport var withListener = function withListener(_ref) {\n    var _ref$eventType = _ref.eventType,\n        eventType = _ref$eventType === undefined ? \"click\" : _ref$eventType,\n        _ref$prop = _ref.prop,\n        prop = _ref$prop === undefined ? \"listener\" : _ref$prop,\n        _ref$mountOn = _ref.mountOn,\n        mountOn = _ref$mountOn === undefined ? null : _ref$mountOn,\n        _ref$autoMount = _ref.autoMount,\n        autoMount = _ref$autoMount === undefined ? false : _ref$autoMount,\n        _ref$regulate = _ref.regulate,\n        regulate = _ref$regulate === undefined ? false : _ref$regulate;\n    return function (Component) {\n        return {\n            name: \"withListener-\" + Component.name,\n            props: Component.props ? [].concat(_toConsumableArray(Component.props)) : [],\n            created: function created() {\n                if (autoMount) this.mount(this);\n            },\n            beforeDestroy: function beforeDestroy() {\n                this.unmount();\n            },\n            beforeUpdate: function beforeUpdate() {\n                if (mountOn) mountOn(this.$props) ? this.mount(this) : this.unmount();\n            },\n\n            data: function data() {\n                return {\n                    listening: false,\n                    ticking: false,\n                    callback: null\n                };\n            },\n            methods: {\n                /* Subscriptions */\n\n                subscribe: function subscribe(cb) {\n                    this.callback = cb;\n                },\n                onEvent: function onEvent(event) {\n                    var _this = this;\n\n                    if (this.callback) {\n                        if (regulate) {\n                            if (!this.ticking) {\n                                var callback = this.callback;\n                                window.requestAnimationFrame(function () {\n                                    return callback(event, function () {\n                                        _this.ticking = false;\n                                    });\n                                });\n                            }\n                            this.ticking = true;\n                        } else this.callback(event);\n                    }\n                },\n\n\n                /* Events */\n\n                mount: function mount() {\n                    if (!this.listening) {\n                        document.addEventListener(eventType, this.onEvent);\n                        this.listening = true;\n                    }\n                },\n                unmount: function unmount() {\n                    if (this.listening) {\n                        document.removeEventListener(eventType, this.onEvent);\n                        this.listening = false;\n                    }\n                }\n            },\n            render: function render() {\n                var h = arguments[0];\n\n                var listener = _defineProperty({}, prop, {\n                    subscribe: this.subscribe,\n                    mount: this.mount,\n                    unmount: this.unmount\n                });\n                var props = {\n                    props: _extends({}, this.$props, listener)\n                };\n                return h(Component, props);\n            }\n        };\n    };\n};\n//# sourceMappingURL=listener.js.map","import _mergeJSXProps from \"babel-helper-vue-jsx-merge-props\";\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nimport { array, object } from \"@bosket/tools\";\nimport { TreeNode } from \"@bosket/core\";\nimport { withTransition } from \"../traits\";\n\nvar TreeViewNodeBase = {\n    name: \"TreeViewNode\",\n    created: function created() {\n        var _this = this;\n\n        var _inputs = { get: function get() {\n                return _this.$props;\n            } };\n        var _state = {\n            get: function get() {\n                return _this.$data;\n            },\n            set: function set(s) {\n                for (var key in s) {\n                    if (key in _this.$data) _this.$data[key] = s[key];\n                }\n            }\n        };\n        this.node = new TreeNode(_inputs, {}, _state, function () {\n            if (!_this._unmounted) _this.$forceUpdate();\n        });\n    },\n    beforeDestroy: function beforeDestroy() {\n        this._unmounted = true;\n    },\n\n    props: [\"model\", \"category\", \"selection\", \"onSelect\", \"display\", \"strategies\", \"dragndrop\", \"labels\", \"sort\", \"disabled\", \"openerOpts\", \"async\", \"css\", \"folded\", \"transition\", \"unique\", \"loading\", \"depth\", \"ancestors\", \"searched\", \"onSelect\", \"filteredModel\"],\n    data: function data() {\n        return {\n            unfolded: []\n        };\n    },\n    computed: {\n        childrenModel: function childrenModel() {\n            var _this2 = this;\n\n            var map = new Map();\n            this.$props.model.forEach(function (item) {\n                if (_this2.node.hasChildren(item) && !_this2.node.isAsync(item)) map.set(item, _this2.$props.sort ? item[_this2.$props.category].sort(_this2.$props.sort) : item[_this2.$props.category]);\n            });\n            return map;\n        },\n        rootDragData: function rootDragData() {\n            var rootData = this.node.getDragEvents(null, !this.$props.depth);\n            return _extends({\n                attrs: { draggable: rootData.draggable }\n            }, object(rootData).nestPrefix(\"on\", function (_) {\n                return _.toLowerCase();\n            }));\n        }\n    },\n    render: function render() {\n        var _this3 = this;\n\n        var h = arguments[0];\n\n        var renderSubtree = function renderSubtree(item) {\n            if (!_this3.node.hasChildren(item) && !_this3.node.isAsync(item)) return null;\n\n            var filteredModel = null;\n\n            /* If data has to be retrieved asynchronously */\n            if (_this3.node.isAsync(item) && !_this3.node.isFolded(item) && !array(_this3.node.pending).contains(item)) {\n                _this3.node.unwrapPromise(item);\n            }\n            if (_this3.$props.filteredModel) {\n                filteredModel = _this3.$props.filteredModel.get(item);\n            }\n\n            var data = {\n                props: _extends({}, _this3.$props, {\n                    model: _this3.childrenModel.get(item),\n                    filteredModel: filteredModel,\n                    ancestors: [].concat(_toConsumableArray(_this3.$props.ancestors), [item]),\n                    depth: (_this3.$props.depth || 0) + 1,\n                    folded: _this3.node.isFolded(item),\n                    loading: _this3.node.isAsync(item) && !_this3.node.isFolded(item)\n                })\n            };\n\n            return h(TreeViewNode, data);\n        };\n\n        var renderOpener = function renderOpener(item, OpenerComponent) {\n            return function (position) {\n                return (_this3.node.hasChildren(item) && item[_this3.$props.category].length > 0 || _this3.node.isAsync(item)) && _this3.$props.openerOpts.position === position ? h(OpenerComponent, { \"class\": _this3.node.mixCss(\"opener\"), on: {\n                        \"click\": _this3.node.onOpener(item, _this3.$props.openerOpts.callback)\n                    }\n                }) : null;\n            };\n        };\n\n        var _$props = this.$props,\n            model = _$props.model,\n            folded = _$props.folded,\n            display = _$props.display,\n            loading = _$props.loading;\n\n\n        if (folded) return null;\n\n        /* If data has to be retrieved asynchronously */\n        if (loading) {\n            return h(\"span\");\n        }\n\n        var OpenerComponent = this.$props.opener || \"span\";\n        var list = model.filter(function (m) {\n            return !_this3.$props.searched || _this3.$props.filteredModel && _this3.$props.filteredModel.has(m);\n        }).map(function (item, idx) {\n            var rawLiData = _extends({}, _this3.node.getDragEvents(item), {\n                \"class\": _this3.node.liCss(item)\n            });\n            var liData = _extends({\n                attrs: { draggable: rawLiData.draggable }\n            }, object(rawLiData).nestPrefix(\"on\", function (_) {\n                return _.toLowerCase();\n            }));\n            if (_this3.$props.unique) liData.key = _this3.$props.unique(item, idx);\n            return h(\n                \"li\",\n                liData,\n                [h(\n                    \"span\",\n                    { \"class\": _this3.node.mixCss(\"item\"), on: {\n                            \"click\": _this3.node.onClick(item)\n                        }\n                    },\n                    [renderOpener(item, OpenerComponent)(\"left\"), display && display(item, _this3.$props), renderOpener(item, OpenerComponent)(\"right\")]\n                ), renderSubtree(item)]\n            );\n        });\n\n        return h(\n            \"ul\",\n            _mergeJSXProps([{ \"class\": this.node.ulCss() }, this.rootDragData]),\n            [list]\n        );\n    }\n};\n\nexport var TreeViewNode = withTransition({ key: function key(props) {\n        return props.folded || props.loading;\n    } })(TreeViewNodeBase);\n//# sourceMappingURL=TreeViewNode.js.map","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nimport { object } from \"@bosket/tools\";\nimport { RootNode, defaults } from \"@bosket/core\";\nimport { TreeViewNode } from \"./TreeViewNode\";\nimport { combine, withLabels, withListener } from \"../traits\";\n\nvar TreeViewBase = {\n    name: \"TreeView\",\n    props: [\"model\", \"category\", \"selection\", \"onSelect\", \"display\", \"search\", \"transition\", \"strategies\", \"labels\", \"css\", \"dragndrop\", \"sort\", \"disabled\", \"openerOpts\", \"async\", \"keyUpListener\", \"keyDownListener\", \"unique\"],\n    data: function data() {\n        return {\n            searchInput: \"\",\n            filtered: null\n        };\n    },\n    methods: {\n        onSearch: function onSearch(evt) {\n            var input = evt.currentTarget.value;\n            this.$data.searchInput = input;\n            this.$data.filtered = this.rootNode.filterTree(input);\n        }\n    },\n    computed: {\n        computedModel: function computedModel() {\n            return this.$props.sort ? this.$props.model.sort(this.$props.sort) : this.$props.model;\n        },\n        wrapDragNDrop: function wrapDragNDrop() {\n            return this.rootNode.wrapDragNDrop();\n        }\n    },\n    created: function created() {\n        var _this = this;\n\n        var _props = {\n            get: function get() {\n                return _extends({}, defaults, object(_this.$props).filter(function (prop) {\n                    return !!prop;\n                }));\n            }\n        };\n        var _outputs = {\n            onSelect: this.$props.onSelect,\n            onDrag: this.$props.dragndrop && this.$props.dragndrop.drag,\n            onOver: this.$props.dragndrop && this.$props.dragndrop.over,\n            onEnter: this.$props.dragndrop && this.$props.dragndrop.enter,\n            onLeave: this.$props.dragndrop && this.$props.dragndrop.leave,\n            onDrop: this.$props.dragndrop && this.$props.dragndrop.drop,\n            onCancel: this.$props.dragndrop && this.$props.dragndrop.cancel\n        };\n        var _state = {\n            get: function get() {\n                return _extends({}, _this.$data);\n            },\n            set: function set(s) {\n                for (var key in s) {\n                    if (key in _this.$data) _this.$data[key] = s[key];\n                }\n            }\n        };\n        this.rootNode = new RootNode(_props, _outputs, _state, this.$forceUpdate);\n    },\n    mounted: function mounted() {\n        this.keyUpListener.subscribe(this.rootNode.onKey);\n        this.keyDownListener.subscribe(this.rootNode.onKey);\n    },\n    render: function render() {\n        var h = arguments[0];\n\n        var _object$filter = object(this.$props).filter(function (prop) {\n            return !!prop;\n        }),\n            onSelect = _object$filter.onSelect,\n            sort = _object$filter.sort,\n            model = _object$filter.model,\n            rest = _objectWithoutProperties(_object$filter, [\"onSelect\", \"sort\", \"model\"]);\n\n        var data = {\n            props: _extends({}, defaults, rest, {\n                model: this.computedModel,\n                filteredModel: this.$data.filtered,\n                onSelect: this.rootNode.onSelect,\n                dragndrop: this.wrapDragNDrop,\n                ancestors: [],\n                sort: sort,\n                folded: false,\n                searched: !!this.$data.searchInput.trim()\n            })\n        };\n\n        var searchBar = !this.$props.search ? null : h(\"input\", {\n            attrs: {\n                type: \"search\",\n\n                placeholder: this.$props.labels && this.$props.labels[\"search.placeholder\"]\n            },\n            \"class\": this.rootNode.mixCss(\"search\"),\n            domProps: {\n                \"value\": this.$data.searchInput\n            },\n            on: {\n                \"input\": this.onSearch\n            }\n        });\n\n        return h(\n            \"div\",\n            { \"class\": this.rootNode.mixCss(\"TreeView\") },\n            [searchBar, h(TreeViewNode, data)]\n        );\n    }\n};\n\nexport var TreeView = combine(withLabels(defaults.labels), withListener({ eventType: \"keyup\", prop: \"keyUpListener\", autoMount: true }), withListener({ eventType: \"keydown\", prop: \"keyDownListener\", autoMount: true }))(TreeViewBase);\n//# sourceMappingURL=TreeView.js.map","export * from \"./labels\";\nexport * from \"./transitions\";\nexport * from \"./listener\";\n\n/* HOC reducer helper */\nexport var combine = function combine() {\n    for (var _len = arguments.length, factories = Array(_len), _key = 0; _key < _len; _key++) {\n        factories[_key] = arguments[_key];\n    }\n\n    return function (Component) {\n        return factories.reduce(function (accu, factory) {\n            return factory(accu);\n        }, Component);\n    };\n};\n//# sourceMappingURL=index.js.map","var nestRE = /^(attrs|props|on|nativeOn|class|style|hook)$/\n\nmodule.exports = function mergeJSXProps (objs) {\n  return objs.reduce(function (a, b) {\n    var aa, bb, key, nestedKey, temp\n    for (key in b) {\n      aa = a[key]\n      bb = b[key]\n      if (aa && nestRE.test(key)) {\n        // normalize class\n        if (key === 'class') {\n          if (typeof aa === 'string') {\n            temp = aa\n            a[key] = aa = {}\n            aa[temp] = true\n          }\n          if (typeof bb === 'string') {\n            temp = bb\n            b[key] = bb = {}\n            bb[temp] = true\n          }\n        }\n        if (key === 'on' || key === 'nativeOn' || key === 'hook') {\n          // merge functions\n          for (nestedKey in bb) {\n            aa[nestedKey] = mergeFn(aa[nestedKey], bb[nestedKey])\n          }\n        } else if (Array.isArray(aa)) {\n          a[key] = aa.concat(bb)\n        } else if (Array.isArray(bb)) {\n          a[key] = [aa].concat(bb)\n        } else {\n          for (nestedKey in bb) {\n            aa[nestedKey] = bb[nestedKey]\n          }\n        }\n      } else {\n        a[key] = b[key]\n      }\n    }\n    return a\n  }, {})\n}\n\nfunction mergeFn (a, b) {\n  return function () {\n    a && a.apply(this, arguments)\n    b && b.apply(this, arguments)\n  }\n}\n"],"sourceRoot":""}